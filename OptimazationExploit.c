#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>

void vaild(char input[64], char pwd[64]){
    strcpy(pwd, "password1");
    printf("pwd: %p\n", pwd);
    if (strcmp(pwd, input) == 0)
        printf("valid!!\n");
        
    hexDump("pwd", pwd, 9);
    memset(pwd, 0, sizeof(pwd)); // cleanup
}

void hexDump(char *desc, void *addr, int len);

int main(){
    char input[64];
    char pwd[64];

    printf("auth yourself:\n");
    gets(input);

    printf("intput: %p\n", input);
    vaild(input, pwd);

    hexDump("input", input, 9);
    hexDump("pwd", input+0x40, 9);
    return 0;
}


void hexDump(char *desc, void *addr, int len){

    int i;
    unsigned char buff[17];
    unsigned char *pc = addr;

    if(desc != NULL)
        printf("%s:\n", desc);
    
    for(i = 0; i < len; i++){
        if ((i % 16) == 0){
            if(i != 0)
                printf("\t%s\n", buff);

            printf("\t%04x ", i);
        }
        printf(" %02x", pc[i]);

        if( (pc[i] < 0x20) || (pc[i] > 0x7e))
            buff[i % 16] = '.';
        else
            buff[(i % 16) + 1] = pc[i];
        buff[(i % 16) + 1] = '\0';
    }

    printf("\n");
}